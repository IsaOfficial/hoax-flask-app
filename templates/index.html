<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <title>Sistem Prediksi Berita Hoaks</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-light">
    <div class="container py-5">
      <div class="card shadow-lg">
        <div class="card-body text-center">
          <h2 class="fw-bold mb-3">
            Sistem Prediksi Berita Hoaks Bahasa Indonesia
          </h2>

          <p class="text-muted">
            Aplikasi ini dikembangkan sebagai luaran tambahan dari penelitian
            berjudul "Analisis Pengaruh Random Oversampling (ROS) terhadap
            Kinerja XGBoost dalam Memprediksi Berita Hoaks Berbahasa Indonesia".
            Sistem ini menggunakan model klasifikasi untuk menprediksi apakah
            suatu berita merupakan <b>HOAKS</b> atau <b>ASLI</b>, dengan
            memanfaatkan algoritma XGBoost dan pendekatan Random Oversampling
            (ROS) untuk menangani masalah ketidakseimbangan data. Aplikasi ini
            bertujuan untuk memberikan alat bantu yang efektif dalam
            mengidentifikasi berita hoaks sehingga dapat membantu masyarakat
            dalam menyaring informasi yang mereka terima. Dengan antarmuka yang
            sederhana dan mudah digunakan, pengguna dapat dengan cepat menguji
            model dan melakukan prediksi terhadap teks berita yang mereka
            masukkan. Sistem ini diharapkan dapat berkontribusi dalam upaya
            memerangi penyebaran informasi palsu di Indonesia.
          </p>

          <hr class="my-4" />

          <div class="row g-3 justify-content-center">
            <div class="col-md-4 d-grid">
              <a href="/predict-page" class="btn btn-success btn-lg">
                Prediksi Berita Hoaks
              </a>
            </div>
          </div>

          <hr class="my-4" />
          <!-- Header -->
          <div class="text-center my-4">
            <h4 class="fw-bold">
              Visualisasi Perbandingan Hasil Evaluasi Model XGBoost dengan dan
              tanpa ROS
            </h4>
          </div>

          <!-- Metrics Table -->
          <div class="card shadow-sm mb-4">
            <div class="card-body">
              <h5 class="mb-3">Perbandingan Metrik Evaluasi</h5>
              <table class="table table-bordered text-center mt-3">
                <thead class="table-light">
                  <tr>
                    <th>Metrik</th>
                    <th>XGBoost-Baseline</th>
                    <th>XGBoost+ROS</th>
                  </tr>
                </thead>
                <tbody>
                  {% for key, value in metrics.baseline.items() %} {% if key !=
                  "Model" %}
                  <tr>
                    <td>{{ key }}</td>
                    <td>{{ "%.4f"|format(metrics.baseline[key]) }}</td>
                    <td>{{ "%.4f"|format(metrics.ros[key]) }}</td>
                  </tr>
                  {% endif %} {% endfor %}
                </tbody>
              </table>
            </div>
          </div>

          <div class="card shadow-sm mb-4">
            <div class="card-body">
              <h5>Perbandingan Metrik (Bar Chart)</h5>
              <canvas id="barChart"></canvas>
            </div>
          </div>

          <div class="card shadow-sm mb-4">
            <div class="card-body">
              <h5>ROC Curve</h5>
              <canvas id="rocChart"></canvas>
            </div>
          </div>

          <div class="card shadow-sm mb-4">
            <div class="card-body">
              <h5>Precision-Recall Curve</h5>
              <canvas id="prChart"></canvas>
            </div>
          </div>

          <div class="card shadow-sm mb-4">
            <div class="card-body">
              <h5>Confusion Matrix</h5>
              <div class="row">
                <div class="col-md-6">
                  <h6 class="text-center">XGBoost-Baseline</h6>
                  <canvas id="cmBaseline"></canvas>
                </div>
                <div class="col-md-6">
                  <h6 class="text-center">XGBoost+ROS</h6>
                  <canvas id="cmROS"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% include 'footer.html' %}
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
      const metrics = {{ metrics | tojson | safe }};
      const rocData = {{ roc_data | tojson | safe }};
      const prData = {{ pr_data | tojson | safe }};
      const cmData = {{ cm_data | tojson | safe }};

      document.addEventListener("DOMContentLoaded", function () {

        // ==========================
        // BAR CHART METRICS
        // ==========================
        const metricKeys = Object.keys(metrics.baseline)
          .filter(k => k !== "Model");

        new Chart(document.getElementById("barChart"), {
          type: "bar",
          data: {
            labels: metricKeys,
            datasets: [
              {
                label: "XGBoost-Baseline",
                data: metricKeys.map(k => metrics.baseline[k])
              },
              {
                label: "XGBoost+ROS",
                data: metricKeys.map(k => metrics.ros[k])
              }
            ]
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true,
                max: 1
              }
            }
          }
        });

        // ==========================
        // ROC CURVE
        // ==========================
        new Chart(document.getElementById("rocChart"), {
          type: "line",
          data: {
            datasets: [
              {
                label: "XGBoost-Baseline",
                data: rocData.baseline.fpr.map((fpr, i) => ({
                  x: fpr,
                  y: rocData.baseline.tpr[i]
                }))
              },
              {
                label: "XGBoost+ROS",
                data: rocData.ros.fpr.map((fpr, i) => ({
                  x: fpr,
                  y: rocData.ros.tpr[i]
                }))
              }
            ]
          },
          options: {
            scales: {
              x: { type: "linear", title: { display: true, text: "False Positive Rate" } },
              y: { title: { display: true, text: "True Positive Rate" } }
            }
          }
        });

        // ==========================
        // PR CURVE
        // ==========================
        new Chart(document.getElementById("prChart"), {
          type: "line",
          data: {
            datasets: [
              {
                label: "XGBoost-Baseline",
                data: prData.baseline.recall.map((rec, i) => ({
                  x: rec,
                  y: prData.baseline.precision[i]
                }))
              },
              {
                label: "XGBoost+ROS",
                data: prData.ros.recall.map((rec, i) => ({
                  x: rec,
                  y: prData.ros.precision[i]
                }))
              }
            ]
          },
          options: {
            scales: {
              x: { type: "linear", title: { display: true, text: "Recall" } },
              y: { title: { display: true, text: "Precision" } }
            }
          }
        });

        // ==========================
        // CONFUSION MATRIX
        // ==========================
        function renderCM(canvasId, matrix) {
          new Chart(document.getElementById(canvasId), {
            type: "bar",
            data: {
              labels: ["TN", "FP", "FN", "TP"],
              datasets: [{
                label: "Jumlah",
                data: [
                  matrix[0][0],
                  matrix[0][1],
                  matrix[1][0],
                  matrix[1][1]
                ]
              }]
            },
            options: {
              responsive: true
            }
          });
        }

        renderCM("cmBaseline", cmData.baseline);
        renderCM("cmROS", cmData.ros);
      });
    </script>
  </body>
</html>
